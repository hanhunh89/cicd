# gitlab을 이용한 CI/CD
작성한 문서가 한번 날라갔다. 행복하지 않다. github는 왜 자동저장이 안되는걸까...<br>

CI는 Continuous Integeration, CD는 Continuous Development를 의미한다.<br>
개발된 소스를 편하게 통합하고, 편하게 배포하자는 것이다.<br>
물론, 버전관리와 품질관리도 포함하는 의미이다.<br>
gitlab의 CI/CD 기능을 살펴보자. <br>

## 들어가면서
김또비는 it 회사에 시스템 엔지니어로 입사했다. 이 회사는 한달에 한번 배포한다.<br>
오늘은 한달동안 열심히 개발한 소스코드를 운영서버에 적용하는 날이다.<br>
개발자와 서버 담당자 모두가 야근을 해야 한다.<br>
개발서버에서 잘 돌아가던 소스코드도 운영서버에서 버그가 생길수 있기 때문이다.<br>

입사한지 육개월이 지났다. 서비스가 엄청 늘어났다.<br>
서비스가 커지면서 수시로 배포를 해야하는 경우가 생겼다.<br>
한달에 한번 야근하던 김또비는 이제 매일 야근을 해야한다.<br>
지옥문이 열린다.<br>
퇴사한다.<br>

CI/CD를 이용하면 이런 비참한 현실을 막을 수 있다.<br>


## gitlab CI/CD 작동 원리
1. gitlab 프로젝트에서 소스코드를 수정 후 commit을 한다.
2. gitlab에서 runner에게 "배포를 해버렷!" 지시한다.<br>
   이 때, 1번을 생략하고 수동으로 배포할 수 있다.<br>
   배포 서버에는 runner가 프로세스 형태로 동작하고 있다.<br>
   배포를 해버렷! 지시를 하면 gitlab에서 배포서버의 runner에게 https 프로토콜을 이용하여 지시를 한다.<br>
   runner의 default 포트는 443이다. <br>
   다른 프로세스(apache, nginx, etc)가 443을 사용하면 포트를 변경해야 한다.    
4. runner는 배포서버에서 .gitlab-ci.yml에 정의된 동작을 시행한다. <br>
   .gitlab-ci.yml은 gitlab 프로젝트 최상위 폴더에 위치한다.<br>
   이 파일에는 빌드, 테스트, 배포 명령어가 명시되어있다. 

## 이 포스트에서 하는일
1. gitlab 프로젝트를 생성한다.
2. 배포서버에 runner를 설치한다.
3. .gitlab-ci.yml 파일을 작성한다.
4. 실제 배포를 하면서 변화를 관찰한다. 
